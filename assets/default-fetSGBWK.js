import{_ as g,x as y,p as x,z as $,B as L,c as E,o as m,w as b,q as k,b as B,h as v,d as A}from"./index-DMIItOgu.js";import{L as T}from"./main-BV8dhSzj.js";import"./useUtility-D4p8Kdq9.js";import"./useAcl-BrK1RmpZ.js";const U={key:0,class:"legacy-loader"},s="legacy-harbor-root",i="/harbor/__legacy",C={__name:"default",setup(H){const d=k(),a=y(!0);function p(){const o=d.fullPath.replace(/\?.*$/,"").replace(/#.*$/,"").replace(/^\/harbor/,"").replace(/\/$/,"");return`${window.location.origin}${i}${o||""}/index.html`}async function u(){const o=p();try{const e=await fetch(o,{credentials:"same-origin"});if(!e.ok)throw new Error(`Load fail ${e.status} @ ${o}`);let n=await e.text();const c=document.getElementById(s);if(!c)throw new Error(`No container #${s}`);c.innerHTML="";const r=document.createElement("div");r.innerHTML=n;const f=r.querySelector("#__nuxt");if(!f)throw new Error("No __nuxt root found in legacy HTML");c.appendChild(f);const h=r.querySelectorAll("link[rel='stylesheet']");for(const l of h){const t=document.createElement("link");t.rel="stylesheet";const _=new URL(l.getAttribute("href"),e.url).href.replace(`${window.location.origin}/_nuxt/`,`${window.location.origin}${i}/_nuxt/`);t.href=_,document.head.appendChild(t)}const w=r.querySelectorAll("script[src]");for(const l of w){const t=document.createElement("script");t.async=!0,t.src=new URL(l.getAttribute("src"),e.url).href.replace(`${window.location.origin}/_nuxt/`,`${window.location.origin}${i}/_nuxt/`),document.body.appendChild(t)}a.value=!1,window.scrollTo(0,0)}catch(e){console.error("Legacy page injection failed:",e);const n=document.getElementById(s);n&&(n.innerHTML='<p style="color:red">Legacy page not found.</p>'),a.value=!1}}return x(()=>{u()}),$(()=>d.fullPath,()=>{u()}),L(()=>{}),(o,e)=>(m(),E(T,null,{default:b(()=>[a.value?(m(),B("div",U,"Loading legacy module...")):v("",!0),e[0]||(e[0]=A("div",{id:"legacy-harbor-root",class:"rounded-1 overflow-hidden"},null,-1))]),_:1}))}},I=g(C,[["__scopeId","data-v-8323a4e2"]]);export{I as default};
