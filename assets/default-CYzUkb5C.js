import{_ as M,c as H,o as v,w as N,m as b,l as k,k as A,y as S,A as T,a as R,f as C,b as I}from"./index-Csnn_HCA.js";import{L as U}from"./main-DdvDDD4J.js";import"./useUtility-DLVUOwel.js";import"./useAcl-CRVvv2YK.js";const d="legacy-corporate-root",f="/corporate/__legacy",l="legacy-corporate-asset",j={__name:"default",setup(B,{expose:s}){s();const i=b(),n=k(!0);function m(e){return e.replace(/\?.*$/,"").replace(/#.*$/,"").replace(/^\/corporate/,"").replace(/\/$/,"")}function p(){const e=m(i.fullPath),r=`${window.location.origin}${f}${e||""}/index.html`,c=`${window.location.origin}${f}/index.html`;return{primary:r,fallback:c,rel:e}}function _(){document.querySelectorAll(`link[rel="stylesheet"][data-${l}]`).forEach(e=>e.remove()),document.querySelectorAll(`script[data-${l}]`).forEach(e=>e.remove())}function h(e){const r="/_nuxt/",c=e.indexOf(r);if(c===-1)return e;const t=e.slice(c+r.length);return`${window.location.origin}${f}/_nuxt/${t}`}async function y(){const{primary:e,fallback:r,rel:c}=p();try{let t=await fetch(e,{credentials:"same-origin"}),a="";if(t.ok)a=await t.text();else{if(t=await fetch(r,{credentials:"same-origin"}),!t.ok)throw new Error(`Legacy HTML not found. Tried: ${e} & ${r}`);a=await t.text()}const g=document.getElementById(d);if(!g)throw new Error(`No container #${d}`);g.innerHTML="",_();const u=document.createElement("div");u.innerHTML=a;let L=u.querySelector("#__nuxt");if(!L)throw console.error("Injected HTML DOES NOT contain #__nuxt. URL used:",t.url),new Error("No __nuxt root found in legacy HTML");g.appendChild(L),u.querySelectorAll('link[rel="stylesheet"]').forEach(w=>{const x=w.getAttribute("href")||"",$=new URL(x,t.url).href,o=document.createElement("link");o.rel="stylesheet",o.href=h($),o.setAttribute(`data-${l}`,"1"),document.head.appendChild(o)}),u.querySelectorAll("script[src]").forEach(w=>{const x=w.getAttribute("src")||"",$=new URL(x,t.url).href,o=document.createElement("script");o.async=!0,o.src=h($),o.setAttribute(`data-${l}`,"1"),document.body.appendChild(o)}),n.value=!1,window.scrollTo(0,0)}catch(t){console.error("Legacy page injection failed:",t);const a=document.getElementById(d);a&&(a.innerHTML='<p style="color:red">Legacy page not found.</p>'),n.value=!1}}A(y),S(()=>i.fullPath,y),T(_);const E={containerId:d,route:i,loading:n,LEGACY_BASE:f,ASSET_MARK:l,cleanPathFromHost:m,buildUrls:p,removeInjectedAssets:_,forceNuxtAsset:h,injectNuxtStatic:y,ref:k,onMounted:A,onBeforeUnmount:T,watch:S,get useRoute(){return b},Layout:U};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}},q={key:0,class:"legacy-loader"};function O(B,s,i,n,m,p){return v(),H(n.Layout,null,{default:N(()=>[n.loading?(v(),R("div",q,"Loading legacy module...")):C("v-if",!0),s[0]||(s[0]=I("div",{id:"legacy-corporate-root",class:"rounded-1 overflow-hidden"},null,-1))]),_:1})}const G=M(j,[["render",O],["__scopeId","data-v-44c0994b"],["__file","/Users/ikbalmaulana/Documents/spn/spn-mono-external/apps/remix-host/src/views/corporate/default.vue"]]);export{G as default};
