import{R as y,I as p,x as l}from"./index-CC8WujTB.js";function i(e){const t=y.create({baseURL:e||void 0||"https://spn-serverless.vercel.app",headers:{"Content-Type":"application/json"},timeout:15e3});return t.interceptors.request.use(n=>{const a=p.get("token");return a&&(n.headers.Authorization=`Bearer ${a}`),n}),t}const f=i();function d(e){const t=e;async function n(a){var r;const s=await t.get(`/api/acl/access/${a}/menujs`);return((r=s.data)==null?void 0:r.data)??s.data??[]}return{getMenuTree:n}}function m(e){const t=e;async function n(a){var r;const s=await t.get(`/api/acl/roles/${a}`);return((r=s.data)==null?void 0:r.data)??s.data}return{getRole:n}}function g(e){var t,n,a;return{id:(t=e[0])==null?void 0:t.id,name:(n=e[0])==null?void 0:n.name,defaultRoute:(a=e[0])==null?void 0:a.defaultRoute}}const o={menusByRole:new Map,rolesById:new Map};async function R(e,t){const n=d(t||f);if(o.menusByRole.has(e))return o.menusByRole.get(e);const{values:a}=await n.getMenuTree(e);return a}async function h(e,t){const n=m(t||f);if(o.rolesById.has(e))return o.rolesById.get(e);const{values:a}=await n.getRole(e),s=g(a);return o.rolesById.set(e,s),s}function B(e={}){const t=l(!1),n=l(null),a=e.baseURL?i(e.baseURL):null;async function s(c){try{return t.value=!0,n.value=null,await R(c,a||void 0)}catch(u){return n.value=(u==null?void 0:u.message)||"Gagal memuat menu",[]}finally{t.value=!1}}async function r(c){try{return t.value=!0,n.value=null,await h(c,a||void 0)}catch(u){return n.value=(u==null?void 0:u.message)||"Gagal memuat role",null}finally{t.value=!1}}return{getMenuTreeByRole:s,getRoleById:r,loading:t,error:n}}export{B as u};
