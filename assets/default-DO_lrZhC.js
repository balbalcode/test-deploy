import{_ as E,x as w,p as v,z as L,B,c as $,o as h,w as b,q as k,b as T,h as C,d as P}from"./index-DMIItOgu.js";import{L as I}from"./main-BV8dhSzj.js";import"./useUtility-D4p8Kdq9.js";import"./useAcl-BrK1RmpZ.js";const N={key:0,class:"legacy-loader"},c="legacy-corporate-root",M={__name:"default",setup(R){const u=k(),s=w(!0),g=w(0);async function m(){const t=u.fullPath.replace(/\?.*$/,"").replace(/#.*$/,""),n=new URL(`${t}/index.html`,window.location.origin).href;try{const e=await fetch(n,{credentials:"same-origin"});if(!e.ok)throw new Error(`Failed to load ${n} (${e.status})`);const a=await e.text(),r=document.getElementById(c);if(!r)throw new Error(`No container #${c}`);r.innerHTML="";const l=document.createElement("div");l.innerHTML=a;const f=l.querySelector("#__nuxt");if(!f)throw new Error("No __nuxt root found");r.appendChild(f);const y=l.querySelectorAll("link[rel='stylesheet']");for(const d of y){const o=document.createElement("link");o.rel="stylesheet";const x=d.getAttribute("href");o.href=new URL(x,e.url).href.replace(window.location.origin+"/_nuxt/",window.location.origin+"/_nuxt/"),r.appendChild(o)}const _=l.querySelectorAll("script[src]");for(const d of _){const o=document.createElement("script");o.src=new URL(d.getAttribute("src"),e.url).href.replace(window.location.origin+"/_nuxt/",window.location.origin+"/_nuxt/"),o.async=!0,document.body.appendChild(o)}s.value=!1,window.scrollTo(0,0)}catch(e){console.error("Legacy page injection failed:",e);const a=document.getElementById(c);a&&(a.innerHTML='<p style="color:red">Legacy page not found.</p>'),s.value=!1}}v(()=>{m(),window.addEventListener("modal-opened",()=>{p()}),window.addEventListener("modal-closed",()=>{document.body.style.height=`${parseInt(g.value)}px`})}),L(()=>u.fullPath,()=>{m()});function p(){setTimeout(()=>{const i=document.getElementsByClassName("modal-dialog"),t=document.getElementById(c);for(let n of i){let e=n.parentElement;e=e.parentElement,t&&e&&t.appendChild(e)}},500)}return B(()=>{window.removeEventListener("modal-opened",()=>{p()})}),(i,t)=>(h(),$(I,null,{default:b(()=>[s.value?(h(),T("div",N,"Loading legacy module...")):C("",!0),t[0]||(t[0]=P("div",{id:"legacy-corporate-root",class:"rounded-1 overflow-hidden"},null,-1))]),_:1}))}},S=E(M,[["__scopeId","data-v-6d80c735"]]);export{S as default};
