import{_ as E,x as h,p as b,z as v,B as L,c as B,o as w,w as $,q as k,b as T,h as C,d as P}from"./index-C7q4z5K6.js";import{L as I}from"./main-BAMG-P3x.js";import"./useUtility-DiSe0qvq.js";import"./useAcl-c6D2PK2e.js";const N={key:0,class:"legacy-loader"},c="legacy-harbor-root",M={__name:"default",setup(R){const u=k(),s=h(!0),g=h(0);async function m(){const t=u.fullPath.replace(/\?.*$/,"").replace(/#.*$/,""),n=new URL(`${t}/index.html`,window.location.origin).href;try{const e=await fetch(n,{credentials:"same-origin"});if(!e.ok)throw new Error(`Failed to load ${n} (${e.status})`);const a=await e.text(),r=document.getElementById(c);if(!r)throw new Error(`No container #${c}`);r.innerHTML="";const l=document.createElement("div");l.innerHTML=a;const f=l.querySelector("#__nuxt");if(!f)throw new Error("No __nuxt root found");r.appendChild(f);const y=l.querySelectorAll("link[rel='stylesheet']");for(const d of y){const o=document.createElement("link");o.rel="stylesheet";const x=d.getAttribute("href");o.href=new URL(x,e.url).href.replace(window.location.origin+"/_nuxt/",window.location.origin+"/_nuxt/"),r.appendChild(o)}const _=l.querySelectorAll("script[src]");for(const d of _){const o=document.createElement("script");o.src=new URL(d.getAttribute("src"),e.url).href.replace(window.location.origin+"/_nuxt/",window.location.origin+"/_nuxt/"),o.async=!0,document.body.appendChild(o)}s.value=!1,window.scrollTo(0,0)}catch(e){console.error("Legacy page injection failed:",e);const a=document.getElementById(c);a&&(a.innerHTML='<p style="color:red">Legacy page not found.</p>'),s.value=!1}}b(()=>{m(),window.addEventListener("modal-opened",()=>{p()}),window.addEventListener("modal-closed",()=>{document.body.style.height=`${parseInt(g.value)}px`})}),v(()=>u.fullPath,()=>{m()});function p(){setTimeout(()=>{const i=document.getElementsByClassName("modal-dialog"),t=document.getElementById(c);for(let n of i){let e=n.parentElement;e=e.parentElement,t&&e&&t.appendChild(e)}},500)}return L(()=>{window.removeEventListener("modal-opened",()=>{p()})}),(i,t)=>(w(),B(I,null,{default:$(()=>[s.value?(w(),T("div",N,"Loading legacy module...")):C("",!0),t[0]||(t[0]=P("div",{id:"legacy-harbor-root",class:"rounded-1 overflow-hidden"},null,-1))]),_:1}))}},S=E(M,[["__scopeId","data-v-bfb2a4bb"]]);export{S as default};
