import{_ as L,x as y,p as B,z as $,B as k,c as C,o as _,w as T,q as b,b as I,h as M,d as N}from"./index-C7q4z5K6.js";import{L as P}from"./main-BAMG-P3x.js";import"./useUtility-DiSe0qvq.js";import"./useAcl-c6D2PK2e.js";const q={key:0,class:"legacy-loader"},l="legacy-corporate-root",s="",A={__name:"default",setup(H){const m=b(),d=y(!0),w=y(0);async function p(){const r=m.fullPath,t=`${s}${r}/index.html`;console.log(t,"here?");try{const o=await fetch(t);if(!o.ok)throw new Error(`Failed to load ${t}`);let e=await o.text();e=e.replace(/(src|href)="\/_nuxt\//g,`$1="${s}/_nuxt/`).replace(/(src|href)='\/_nuxt\//g,`$1='${s}/_nuxt/`).replace(/"\/_nuxt\//g,`"${s}/_nuxt/`);const c=document.getElementById(l);c&&(c.innerHTML="");const n=document.createElement("div");n.innerHTML=e,console.log(n,"container");const h=n.querySelector("#__nuxt");if(!h)throw new Error("No __nuxt root found");c.appendChild(h);const x=n.querySelectorAll("link[rel='stylesheet']");for(const i of x){const u=i.getAttribute("href"),a=await fetch(u).then(E=>E.text()),g=document.createElement("style");g.textContent=`#${l} { all: initial; }
`+a,c.appendChild(g)}const v=n.querySelectorAll("script[src]");for(const i of v){const u=i.getAttribute("src"),a=document.createElement("script");a.src=u,a.async=!0,document.body.appendChild(a)}d.value=!1,window.scrollTo(0,0)}catch(o){console.error("Legacy page injection failed:",o);const e=document.getElementById(l);e&&(e.innerHTML='<p style="color:red">Legacy page not found.</p>')}d.value=!1}B(()=>{p(),window.addEventListener("modal-opened",()=>{f()}),window.addEventListener("modal-closed",()=>{document.body.style.height=`${parseInt(w.value)}px`})}),$(()=>m.fullPath,()=>{p()});function f(){setTimeout(()=>{const r=document.getElementsByClassName("modal-dialog"),t=document.getElementById(l);for(let o of r){let e=o.parentElement;e=e.parentElement,t&&e&&t.appendChild(e)}},500)}return k(()=>{window.removeEventListener("modal-opened",()=>{f()})}),(r,t)=>(_(),C(P,null,{default:T(()=>[d.value?(_(),I("div",q,"Loading legacy module...")):M("",!0),t[0]||(t[0]=N("div",{id:"legacy-corporate-root",class:"rounded-1 overflow-hidden"},null,-1))]),_:1}))}},W=L(A,[["__scopeId","data-v-6c6656db"]]);export{W as default};
