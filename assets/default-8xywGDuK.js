import{_ as x,x as f,p as E,z as v,B as L,c as b,o as h,w as B,q as k,b as $,h as T,d as C}from"./index-B0Z-KfBl.js";import{L as I}from"./main-BexHO07w.js";import"./useUtility-B8MkqClZ.js";import"./useAcl-DvV7wdVn.js";const N={key:0,class:"legacy-loader"},l="legacy-harbor-root",P={__name:"default",setup(M){const c=k(),s=f(!0),w=f(0);async function u(){c.fullPath.replace(/\?.*$/,"").replace(/#.*$/,"");const o=`/__legacy/harbor${c.fullPath.replace("/harbor","")}/index.html`;try{const e=await fetch(o,{credentials:"same-origin"});if(!e.ok)throw new Error(`Failed to load ${o} (${e.status})`);const t=await e.text(),r=document.getElementById(l);if(!r)throw new Error(`No container #${l}`);r.innerHTML="";const a=document.createElement("div");a.innerHTML=t;const p=a.querySelector("#__nuxt");if(!p)throw new Error("No __nuxt root found");r.appendChild(p);const g=a.querySelectorAll("link[rel='stylesheet']");for(const d of g){const n=document.createElement("link");n.rel="stylesheet";const _=d.getAttribute("href");n.href=new URL(_,e.url).href.replace(window.location.origin+"/_nuxt/",window.location.origin+"/_nuxt/"),r.appendChild(n)}const y=a.querySelectorAll("script[src]");for(const d of y){const n=document.createElement("script");n.src=new URL(d.getAttribute("src"),e.url).href.replace(window.location.origin+"/_nuxt/",window.location.origin+"/_nuxt/"),n.async=!0,document.body.appendChild(n)}s.value=!1,window.scrollTo(0,0)}catch(e){console.error("Legacy page injection failed:",e);const t=document.getElementById(l);t&&(t.innerHTML='<p style="color:red">Legacy page not found.</p>'),s.value=!1}}E(()=>{u(),window.addEventListener("modal-opened",()=>{m()}),window.addEventListener("modal-closed",()=>{document.body.style.height=`${parseInt(w.value)}px`})}),v(()=>c.fullPath,()=>{u()});function m(){setTimeout(()=>{const i=document.getElementsByClassName("modal-dialog"),o=document.getElementById(l);for(let e of i){let t=e.parentElement;t=t.parentElement,o&&t&&o.appendChild(t)}},500)}return L(()=>{window.removeEventListener("modal-opened",()=>{m()})}),(i,o)=>(h(),b(I,null,{default:B(()=>[s.value?(h(),$("div",N,"Loading legacy module...")):T("",!0),o[0]||(o[0]=C("div",{id:"legacy-harbor-root",class:"rounded-1 overflow-hidden"},null,-1))]),_:1}))}},S=x(P,[["__scopeId","data-v-8cc39d2e"]]);export{S as default};
