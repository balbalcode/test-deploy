const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B9FZvJtd.js","assets/index-BMz2sQyU.css"])))=>i.map(i=>d[i]);
import{_ as S,x as b,p as H,z as B,B as N,c as P,o as x,w as R,q as I,l as M,b as C,h as q,d as O}from"./index-B9FZvJtd.js";import{L as U}from"./main-DkiXzUHs.js";import"./useUtility-Btzcjh6s.js";import"./useAcl-DQ2NrUA6.js";const j={key:0,class:"legacy-loader"},h="legacy-corporate-root",g="/corporate/__legacy",s="legacy-corporate-asset",V="/corporate",D={__name:"default",setup(F){const c=I(),i=b(!0),p=e=>e.replace(/^\/corporate(?=\/|$)/,"")||"/",$=e=>e.startsWith("/corporate")?e:V+e;let d=!1;function y(e){var n;const o=(n=e==null?void 0:e.detail)==null?void 0:n.path;if(!o)return;const t=$(o);c.fullPath!==t&&(d=!0,M(()=>import("./index-B9FZvJtd.js").then(a=>a.W),__vite__mapDeps([0,1])).then(()=>{}).finally(()=>{}))}function w(e){window.dispatchEvent(new CustomEvent("host:navigate",{detail:{path:e}}))}function _(){const e=p(c.fullPath);w(e)}function T(e){return e.replace(/\?.*$/,"").replace(/#.*$/,"").replace(/^\/corporate/,"").replace(/\/$/,"")}function A(){const e=T(c.fullPath),o=`${window.location.origin}${g}${e||""}/index.html`,t=`${window.location.origin}${g}/index.html`;return{primary:o,fallback:t,rel:e}}function k(){document.querySelectorAll(`link[rel="stylesheet"][data-${s}]`).forEach(e=>e.remove()),document.querySelectorAll(`script[data-${s}]`).forEach(e=>e.remove())}function v(e){const o="/_nuxt/",t=e.indexOf(o);if(t===-1)return e;const n=e.slice(t+o.length);return`${window.location.origin}${g}/_nuxt/${n}`}async function E(){const{primary:e,fallback:o}=A();try{let t=await fetch(e,{credentials:"same-origin"}),n="";if(t.ok)n=await t.text();else{if(t=await fetch(o,{credentials:"same-origin"}),!t.ok)throw new Error(`Legacy HTML not found. Tried: ${e} & ${o}`);n=await t.text()}const a=document.getElementById(h);if(!a)throw new Error(`No container #${h}`);a.innerHTML="",k();const l=document.createElement("div");l.innerHTML=n;let L=l.querySelector("#__nuxt");if(!L)throw console.error("Injected HTML DOES NOT contain #__nuxt. URL used:",t.url),new Error("No __nuxt root found in legacy HTML");a.appendChild(L),l.querySelectorAll('link[rel="stylesheet"]').forEach(u=>{const f=u.getAttribute("href")||"",m=new URL(f,t.url).href,r=document.createElement("link");r.rel="stylesheet",r.href=v(m),r.setAttribute(`data-${s}`,"1"),document.head.appendChild(r)}),l.querySelectorAll("script[src]").forEach(u=>{const f=u.getAttribute("src")||"",m=new URL(f,t.url).href,r=document.createElement("script");r.async=!0,r.src=v(m),r.setAttribute(`data-${s}`,"1"),document.body.appendChild(r)}),i.value=!1,window.scrollTo(0,0)}catch(t){console.error("Legacy page injection failed:",t);const n=document.getElementById(h);n&&(n.innerHTML='<p style="color:red">Legacy page not found.</p>'),i.value=!1}}return H(()=>{E(),window.addEventListener("legacy:navigate",y),window.addEventListener("legacy:ready",_)}),B(()=>c.fullPath,e=>{if(d){d=!1;return}const o=p(e);w(o),E()}),N(()=>{window.removeEventListener("legacy:navigate",y),window.removeEventListener("legacy:ready",_)}),(e,o)=>(x(),P(U,null,{default:R(()=>[i.value?(x(),C("div",j,"Loading legacy module...")):q("",!0),o[0]||(o[0]=O("div",{id:"legacy-corporate-root",class:"rounded-1 overflow-hidden"},null,-1))]),_:1}))}},X=S(D,[["__scopeId","data-v-9e25e8b1"]]);export{X as default};
