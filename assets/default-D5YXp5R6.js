import{_ as x,x as h,p as E,z as v,B as L,c as b,o as f,w as B,q as k,b as $,h as T,d as C}from"./index-D6Amw8ct.js";import{L as I}from"./main-Csh24i6M.js";import"./useUtility-BOfd2cRl.js";import"./useAcl-CqGDfRb0.js";const N={key:0,class:"legacy-loader"},l="legacy-harbor-root",P={__name:"default",setup(M){const c=k(),s=h(!0),g=h(0);async function u(){c.fullPath.replace(/\?.*$/,"").replace(/#.*$/,"");const o=`/harbor/__legacy/harbor${c.fullPath.replace("/harbor","")}/index.html`;console.log(o,"here");try{const t=await fetch(o,{credentials:"same-origin"});if(!t.ok)throw new Error(`Failed to load ${o} (${t.status})`);let e=await t.text();e=e.replace(/(src|href)="\/_nuxt\//g,""),console.log(t,"reesss"),console.log(e,"html");const r=document.getElementById(l);if(!r)throw new Error(`No container #${l}`);r.innerHTML="";const a=document.createElement("div");a.innerHTML=e;const p=a.querySelector("#__nuxt");if(!p)throw new Error("No __nuxt root found");r.appendChild(p);const w=a.querySelectorAll("link[rel='stylesheet']");for(const d of w){const n=document.createElement("link");n.rel="stylesheet";const _=d.getAttribute("href");n.href=new URL(_,t.url).href.replace(window.location.origin+"/_nuxt/",window.location.origin+"/_nuxt/"),r.appendChild(n)}const y=a.querySelectorAll("script[src]");for(const d of y){const n=document.createElement("script");n.src=new URL(d.getAttribute("src"),t.url).href.replace(window.location.origin+"/_nuxt/",window.location.origin+"/_nuxt/"),n.async=!0,document.body.appendChild(n)}s.value=!1,window.scrollTo(0,0)}catch(t){console.error("Legacy page injection failed:",t);const e=document.getElementById(l);e&&(e.innerHTML='<p style="color:red">Legacy page not found.</p>'),s.value=!1}}E(()=>{u(),window.addEventListener("modal-opened",()=>{m()}),window.addEventListener("modal-closed",()=>{document.body.style.height=`${parseInt(g.value)}px`})}),v(()=>c.fullPath,()=>{u()});function m(){setTimeout(()=>{const i=document.getElementsByClassName("modal-dialog"),o=document.getElementById(l);for(let t of i){let e=t.parentElement;e=e.parentElement,o&&e&&o.appendChild(e)}},500)}return L(()=>{window.removeEventListener("modal-opened",()=>{m()})}),(i,o)=>(f(),b(I,null,{default:B(()=>[s.value?(f(),$("div",N,"Loading legacy module...")):T("",!0),o[0]||(o[0]=C("div",{id:"legacy-harbor-root",class:"rounded-1 overflow-hidden"},null,-1))]),_:1}))}},S=x(P,[["__scopeId","data-v-0dc0e493"]]);export{S as default};
