(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{868:function(t,e,n){"use strict";n.r(e);var r,o=n(1),l=(n(12),n(70),n(43),n(93),n(9),n(42),n(22),n(429)),d={components:(r={DropdownButton:function(){return n.e(21).then(n.bind(null,832))},ModalConfirmation:function(){return n.e(19).then(n.bind(null,831))},ActiveButton:function(){return n.e(0).then(n.bind(null,822))},ContentTableView:function(){return n.e(12).then(n.bind(null,833))},PriceLabel:function(){return n.e(17).then(n.bind(null,834))},LabelStatusGroup:function(){return n.e(14).then(n.bind(null,835))}},r.ActiveButton=function(){return n.e(0).then(n.bind(null,822))},r.CardPaginationView=function(){return n.e(25).then(n.bind(null,836))},r),props:{is_searching:{default:!1},filter:{default:function(){return{}}},selected:{default:function(){return{}}}},data:function(){return{id:"table-payment",corporate:{},data:[],selected_invoice:"",helper:{is_loading:!1,is_error:!1},modal:{modal_delete:!1},pagination:{per_page:10,current_page:1,total_data:0}}},watch:{is_searching:{handler:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=1;break}return n.next=1,e.passUpdatePagination(1);case 1:case"end":return n.stop()}},n)}))()}}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.corporate=JSON.parse(t.$utility.getCookie("corporate")),t.processGetData();case 1:case"end":return e.stop()}},e)}))()},methods:{getMembershipPayment:l.paymentMembershipMethods.getMembershipPayment,deleteCorporateMembershipInvoice:l.paymentMembershipMethods.deleteCorporateMembershipInvoice,passErrorToParent:function(t){this.$emit("error",{state:!0,message:t})},passInvoiceToParent:function(t){this.$emit("invoice",t)},passVehicleToParent:function(t){this.$emit("vehicle",t)},passUpdatePagination:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.pagination.current_page=t,n.next=1,e.processGetData();case 1:case"end":return n.stop()}},n)}))()},setPayloadDelete:function(){return{invoice_id:this.selected_invoice.id}},setPayloadGet:function(){var t={filter:[{key:"corporate_id",value:[this.corporate.id]},{key:"month",value:this.$utility.formatDateMoment(this.filter.month,"YYYY-MM")}],pagination:{current_page:this.pagination.current_page,per_page:this.pagination.per_page},spot_id:this.corporate.spot_id};return this.filter.status&&t.filter.push({key:"status",value:this.filter.status.value}),t},toggleModalDelete:function(data){data?(this.modal.modal_delete=!0,this.selected_invoice=data):(this.modal.modal_delete=!1,this.selected_invoice={})},toggleDownloadPage:function(data){this.$router.push("/payment/member?id="+data.id)},formatStatusPayment:function(t){return t.paid_at?"Telah Membayar":t.transaction_data.payment_data&&Math.floor((new Date).getTime())>t.transaction_data.payment_data.expired_at?"Telah kadaluarsa":"Belum membayar"},processGetData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var n,data,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.helper.is_error=!1,t.helper.is_loading=!0,e.prev=1,n=t.setPayloadGet(),e.next=2,t.getMembershipPayment(n);case 2:data=e.sent,t.data=data.rows,t.pagination.total_data=data.total_values,e.next=4;break;case 3:e.prev=3,r=e.catch(1),t.data=[],t.pagination.total_data=0,t.helper.is_error=!0,t.passErrorToParent(r),t.$utility.setErrorContextSentry(r),t.$sentry.captureMessage(r.message+" at processGetData in TablePaymentHistory");case 4:t.$emit("ready"),t.helper.is_loading=!1;case 5:case"end":return e.stop()}},e,null,[[1,3]])}))()},processDeleteInvoice:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.helper.is_loading=!0,e.prev=1,n=t.setPayloadDelete(),e.next=2,t.deleteCorporateMembershipInvoice(n);case 2:t.toggleModalDelete(),t.processGetData(),e.next=4;break;case 3:e.prev=3,r=e.catch(1),t.$utility.setErrorContextSentry(r),t.$sentry.captureMessage(r.message+" at processGetData in TablePaymentHistory");case 4:t.helper.is_loading=!1;case 5:case"end":return e.stop()}},e,null,[[1,3]])}))()}}},c=n(38),component=Object(c.a)(d,function(){var t=this,e=t._self._c;return e("div",[e("content-table-view",{attrs:{length:t.pagination.total_data,is_loading:t.helper.is_loading,is_error:t.helper.is_error,id:"wrapper__"+t.id,test_id:"wrapper__"+t.id,emptyCaption:"Pilih filter untuk menampilkan data"}},[e("div",{staticClass:"table-responsive rounded-top table-freeze mb-0"},[e("table",{staticClass:"table table-striped table-borderless mb-0 custom-tbl"},[e("thead",{staticClass:"thead-freeze bg-gray-70"},[e("tr",{staticClass:"border-bottom-table"},[e("th",{staticClass:"text-dark"},[t._v("No")]),t._v(" "),e("th",{staticClass:"text-dark"},[t._v("ID Transaksi")]),t._v(" "),e("th",{staticClass:"text-dark text-center"},[t._v("Periode Pembayaran")]),t._v(" "),e("th",{staticClass:"text-dark"},[t._v("Discount")]),t._v(" "),e("th",{staticClass:"text-dark"},[t._v("Pajak")]),t._v(" "),e("th",{staticClass:"text-dark"},[t._v("Admin")]),t._v(" "),e("th",{staticClass:"text-dark"},[t._v("Jumlah Bayar")]),t._v(" "),e("th",{staticClass:"text-dark text-center"},[t._v("Status Pembayaran")]),t._v(" "),e("th",{staticClass:"text-dark"},[t._v("Invoice")])])]),t._v(" "),e("tbody",t._l(t.data,function(n,r){return e("tr",{key:"payment-"+r,class:{"selected-row":t.selected.id===n.id}},[e("td",[t._v("\n              "+t._s(r+10*(t.pagination.current_page-1)+1)+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark"},[t._v("\n              "+t._s(n.id)+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark text-center"},[t._v("\n              "+t._s(n.corporate_detail.cut_off_period)+" Bulan\n            ")]),t._v(" "),e("td",{staticClass:"text-dark text-right",attrs:{"data-testid":"cell-"+r+"__discount"}},[n.transaction_data?e("span",{attrs:{"data-testid":"cell-"+r+"__discount-filled"}},[t._v("\n                "+t._s(t.$utility.convertToRupiah(n.transaction_data.corporate_bill_data.calculated_discount))+"\n                "),"percentage"===n.discount_type?e("span",[t._v("("+t._s(n.transaction_data.corporate_bill_data.discount)+"%)")]):t._e()]):e("span",{attrs:{"data-testid":"cell-"+r+"__discount-blank"}},[t._v("\n                -\n              ")])]),t._v(" "),e("td",{staticClass:"text-dark text-right",attrs:{"data-testid":"cell-"+r+"__tax"}},[n.transaction_data?e("span",{attrs:{"data-testid":"cell-"+r+"__tax-filled"}},[t._v("\n                "+t._s(n.transaction_data.corporate_bill_data.tax)+"%\n              ")]):e("span",{attrs:{"data-testid":"cell-"+r+"__tax-blank"}},[t._v("\n                -\n              ")])]),t._v(" "),e("td",{staticClass:"text-dark text-right",attrs:{"data-testid":"cell-"+r+"__admin"}},[n.corporate_detail.admin_charge?e("span",{attrs:{"data-testid":"cell-"+r+"__admin-filled"}},[t._v("\n                "+t._s(t.$utility.convertToRupiah(n.corporate_detail.admin_charge))+"\n              ")]):e("span",{attrs:{"data-testid":"cell-"+r+"__admin-blank"}},[t._v("\n                -\n              ")])]),t._v(" "),e("td",{staticClass:"text-dark text-right"},[t._v("\n              "+t._s(t.$utility.convertToRupiah(n.calculated_amount))+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark text-center"},[e("label-status-group",{attrs:{is_default_format:!1,text:t.formatStatusPayment(n),variant:n.paid_at?"success":"danger",test_id:t.id+"__tr-"+r+"__td-payment_status"}})],1),t._v(" "),e("td",{staticClass:"text-dark"},[e("dropdown-button",{attrs:{text:"",id:"btn-opt-payment__"+r,test_id:"btn-opt-payment__"+r,size:"sm",variant:"gray",type:"outline",additional_class:"p-0",caret:"font-size-20 bx bx-dots-vertical-rounded",has_custom_action:!0}},[n.paid_at?t._e():e("active-button",{attrs:{text:"Batalkan Pembayaran",additional_class:"border-0 w-100 text-left  p-2 bg-transparent",id:"btn-cancel-payment__"+r,test_id:"btn-cancel-payment__"+r,align:"rtl"},on:{click:function(e){return t.toggleModalDelete(n)}}}),t._v(" "),n.paid_at?e("active-button",{attrs:{text:"Download Membership",additional_class:"border-0 w-100 text-left  p-2 bg-transparent",id:"btn-download-member__"+r,test_id:"btn-download-member__"+r,align:"rtl"},on:{click:function(e){return t.toggleDownloadPage(n)}}}):t._e(),t._v(" "),e("active-button",{attrs:{text:"Lihat Detail",align:"rtl",additional_class:"border-0 w-100 text-left  p-2 bg-transparent",id:"btn-detail_payment__"+r,test_id:"btn-detail_payment__"+r},on:{click:function(e){return t.passInvoiceToParent(n)}}})],1)],1)])}),0)])]),t._v(" "),e("div",{staticClass:"w-100"},[e("div",{staticClass:"col-12 text-center text-lg-right"},[e("card-pagination-view",{attrs:{per_page:t.pagination.per_page,total_data:t.pagination.total_data,additional_class:"mt-3",current_page:t.pagination.current_page,id:"pagination_member",test_id:t.id+"__pagination"},on:{update:t.passUpdatePagination}})],1)])]),t._v(" "),t.modal.modal_delete?e("modal-confirmation",{attrs:{text:"Apakah anda yakin untuk menghapus data tagihan anda yang berjumlah "+t.$utility.convertToRupiah(t.selected_invoice.calculated_amount)+"?",is_loading:t.helper.is_loading,submit_button_text:"Submit"},on:{cancel:function(e){return t.toggleModalDelete()},submit:t.processDeleteInvoice},model:{value:t.modal.modal_delete,callback:function(e){t.$set(t.modal,"modal_delete",e)},expression:"modal.modal_delete"}}):t._e()],1)},[],!1,null,null,null);e.default=component.exports}}]);