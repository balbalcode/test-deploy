(window.webpackJsonp=window.webpackJsonp||[]).push([[120],{863:function(t,e,r){"use strict";r.r(e);r(59);var n,o=r(1),d=(r(12),r(70),r(51),r(130),r(71),r(93),r(9),r(42),r(22),r(429)),_={components:(n={ModalConfirmation:function(){return r.e(19).then(r.bind(null,831))},DropdownButton:function(){return r.e(21).then(r.bind(null,832))},ActiveButton:function(){return r.e(0).then(r.bind(null,822))},ContentTableView:function(){return r.e(12).then(r.bind(null,833))},PriceLabel:function(){return r.e(17).then(r.bind(null,834))},LabelStatusGroup:function(){return r.e(14).then(r.bind(null,835))}},n.ActiveButton=function(){return r.e(0).then(r.bind(null,822))},n.CardPaginationView=function(){return r.e(25).then(r.bind(null,836))},n),props:{is_searching:{default:!1},filter:{default:function(){return{}}},selected:{default:function(){return{}}}},data:function(){return{id:"table-membership",corporate:{},data:[],selected_id:"",helper:{is_loading:!1,is_error:!1},modal:{modal_delete:!1,modal_activate:!1,modal_confirmation:!1},pagination:{per_page:10,current_page:1,total_data:0}}},watch:{is_searching:{handler:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=1;break}return r.next=1,e.passUpdatePagination(1);case 1:case"end":return r.stop()}},r)}))()}}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.corporate=JSON.parse(t.$utility.getCookie("corporate")),t.processGetData();case 1:case"end":return e.stop()}},e)}))()},methods:{getCorporateEmployee:d.corporateMembershipMethods.getCorporateEmployee,deleteCorporateMembership:d.corporateMembershipMethods.deleteCorporateMembership,activateCorporateMembership:d.corporateMembershipMethods.activateCorporateMembership,passErrorToParent:function(t){this.$emit("error",{state:!0,message:t})},passEditToParent:function(data){this.$emit("edit",data)},passCancelToParent:function(){this.modal.modal_delete=!1,this.modal.modal_activate=!1,this.$emit("cancel")},passDeleteToParent:function(data){this.$emit("delete",data)},passActivateToParent:function(data){this.$emit("activate",data)},passUpdatePagination:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e.pagination.current_page=t,r.next=1,e.processGetData();case 1:case"end":return r.stop()}},r)}))()},setPayloadGet:function(){var t={corporate_id:this.corporate.id,filter:[],pagination:{current_page:this.pagination.current_page,per_page:this.pagination.per_page}};return this.filter.name&&t.filter.push({key:"name",value:this.filter.name}),this.filter.status&&t.filter.push({key:"active_status",value:this.filter.status.join(",")}),t},setPayloadActivate:function(){return{id:this.selected.id,active_status:!this.selected.status,corporate_id:this.corporate.id}},setPayloadDelete:function(){return{id:this.selected.id,corporate_id:this.corporate.id}},toggleModalActivate:function(){this.modal.modal_activate=!this.modal.modal_activate},toggleModalDelete:function(){this.modal.modal_delete=!this.modal.modal_delete},toggleFormatMembership:function(data){var t,e={product_name:"",product_price:"",membership_rf_id:"",membership_card_id:"",membership_status:"",license_plate_1:"",license_plate_2:"",license_plate_3:""},r="",n=!1;"CARD"===this.corporate.membership_type?(r="card",n=!data.card.license_plate):(r="motorcycle",n=!(null!=(t=data.motorcycle[0])&&t.license_plate));var source=n?data.expired["expired_"+r]:data[r];return Array.isArray(source)?(e.license_plate_1=source[0]&&source[0].license_plate?source[0].license_plate:"",e.license_plate_2=source[1]&&source[1].license_plate?source[1].license_plate:"",e.license_plate_3=source[2]&&source[2].license_plate?source[2].license_plate:"",e.product_name=source[0].product_detail.name,e.product_price=this.$utility.convertToRupiah(source[0].product_detail.price),e.membership_status=!n):(e.membership_rf_id=source.rf_id,e.membership_card_id=source.card_id,e.product_name=source.product_detail.name,e.product_price=this.$utility.convertToRupiah(source.product_detail.price),e.license_plate_1=source.license_plate,source.second_license_plate&&(e.license_plate_2=source.second_license_plate),e.membership_status=!n),e},processFormatData:function(data){var t=this;this.data=data.map(function(e,r){return e=Object.assign({},e,t.toggleFormatMembership(e))})},processGetData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var r,n,o,d,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.helper.is_error=!1,t.helper.is_loading=!0,e.prev=1,r=t.setPayloadGet(),e.next=2,t.getCorporateEmployee(r);case 2:n=e.sent,o=n.values,d=n.total_values,t.processFormatData(o),t.pagination.total_data=d,e.next=4;break;case 3:e.prev=3,_=e.catch(1),t.data=[],t.pagination.total_data=0,t.helper.is_error=!0,t.passErrorToParent(_),t.$utility.setErrorContextSentry(_),t.$sentry.captureMessage(_.message+" at processGetData in TableCorporateMembership");case 4:t.$emit("ready"),t.helper.is_loading=!1;case 5:case"end":return e.stop()}},e,null,[[1,3]])}))()},processDeleteData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.helper.is_loading=!0,e.prev=1,r=t.setPayloadDelete(),e.next=2,t.deleteCorporateMembership(r);case 2:t.processGetData(),t.toggleModalDelete(),e.next=4;break;case 3:e.prev=3,n=e.catch(1),t.passErrorToParent(n),t.$utility.setErrorContextSentry(n),t.$sentry.captureMessage(n.message+" at processDeleteData in TableCorporateMembership");case 4:t.helper.is_loading=!1;case 5:case"end":return e.stop()}},e,null,[[1,3]])}))()},processActivateData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.helper.is_loading=!0,e.prev=1,r=t.setPayloadActivate(),e.next=2,t.activateCorporateMembership(r);case 2:t.processGetData(),t.toggleModalActivate(),e.next=4;break;case 3:e.prev=3,n=e.catch(1),t.passErrorToParent(n),t.$utility.setErrorContextSentry(n),t.$sentry.captureMessage(n.message+" at processActivateData in TableCorporateMembership");case 4:t.helper.is_loading=!1;case 5:case"end":return e.stop()}},e,null,[[1,3]])}))()}}},l=r(38),component=Object(l.a)(_,function(){var t=this,e=t._self._c;return e("div",[e("content-table-view",{attrs:{length:t.pagination.total_data,is_loading:t.helper.is_loading,is_error:t.helper.is_error,id:"wrapper__"+t.id,test_id:"wrapper__"+t.id,emptyCaption:"Pilih filter untuk menampilkan data"}},[e("div",{staticClass:"table-responsive rounded-top table-freeze mb-0"},[e("table",{staticClass:"table table-striped table-borderless mb-0 custom-tbl",attrs:{"data-testid":t.id}},[e("thead",{staticClass:"thead-freeze bg-gray-70"},[e("tr",{staticClass:"border-bottom-table"},[e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-no"}},[t._v("No")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-name"}},[t._v("Nama")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-phone_number"}},[t._v("\n              No Telepon\n            ")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-dob"}},[t._v("\n              Tanggal Lahir\n            ")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-email"}},[t._v("Email")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-license_plate_1"}},[t._v("\n              Plat No 1\n            ")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-license_plate_2"}},[t._v("\n              Plat No 2\n            ")]),t._v(" "),"LICENSE_PLATE"===t.corporate.membership_type?e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-license_plate_3"}},[t._v("\n              Plat No 3\n            ")]):t._e(),t._v(" "),"CARD"===t.corporate.membership_type?e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-rfid"}},[t._v("\n              RF ID\n            ")]):t._e(),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-product"}},[t._v("\n              Produk\n            ")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-price"}},[t._v("Harga")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-employee-status"}},[t._v("\n              Status Pegawai\n            ")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-membership-status"}},[t._v("\n              Status Member\n            ")]),t._v(" "),e("th",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__th-options"}},[t._v("Opsi")])])]),t._v(" "),e("tbody",t._l(t.data,function(r,n){return e("tr",{key:"member-"+n,class:{"selected-row":t.selected.id===r.id}},[e("td",{attrs:{"data-testid":t.id+"__tr-"+n+"__td-no"}},[t._v("\n              "+t._s(n+10*(t.pagination.current_page-1)+1)+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-name"}},[t._v("\n              "+t._s(r.name)+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-phone_number"}},[t._v("\n              "+t._s(r.additional_data&&r.additional_data.phone_number?r.additional_data.phone_number:"-")+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-dob"}},[t._v("\n              "+t._s(r.additional_data&&r.additional_data.dob?t.$utility.formatDateMoment(r.additional_data.dob,"DD-MM-YYYY"):"-")+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-email"}},[t._v("\n              "+t._s(r.email?r.email:"-")+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-license_plate_1"}},[t._v("\n              "+t._s(r.license_plate_1)+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-license_plate_2"}},[t._v("\n              "+t._s(r.license_plate_2)+"\n            ")]),t._v(" "),"LICENSE_PLATE"===t.corporate.membership_type?e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-license_plate_3"}},[t._v("\n              "+t._s(r.license_plate_3)+"\n            ")]):t._e(),t._v(" "),"CARD"===t.corporate.membership_type?e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-rf_id"}},[t._v("\n              "+t._s(r.membership_rf_id)+"\n            ")]):t._e(),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-product"}},[t._v("\n              "+t._s(r.product_name)+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-price"}},[t._v("\n              "+t._s(r.product_price)+"\n            ")]),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-employee-status"}},[e("label-status-group",{attrs:{default_format_status:!!r.status,size:11,is_bold:!1,additional_class:"font-size-11 text-center pt-1"}})],1),t._v(" "),e("td",{staticClass:"text-dark",attrs:{"data-testid":t.id+"__tr-"+n+"__td-membership-status"}},[e("label-status-group",{attrs:{default_format_status:!!r.membership_status,size:11,is_bold:!1,additional_class:"font-size-11 text-center pt-1"}})],1),t._v(" "),e("td",{staticClass:"text-center",attrs:{"data-testid":t.id+"__tr-"+n+"__td-options"}},[e("dropdown-button",{ref:"btn-action-"+n,refInFor:!0,attrs:{text:"",size:"sm",variant:"gray",type:"outline",additional_class:"p-0",id:"btn_action_"+n,caret:"font-size-20 bx bx-dots-vertical-rounded",has_custom_action:!0,test_id:t.id+"__tr-"+n+"__btn-option"}},[e("active-button",{attrs:{icon:r.status?"bx bx-user-x":"bx bx-user-check",icon_size:"16",icon_color:r.status?"text-warning":"text-success",text_color:r.status?"text-warning":"text-success",text:r.status?"Nonaktifkan":"Aktifkan",additional_class:"border-0 w-100 text-left  p-2 bg-transparent",align:"rtl",id:t.id+"__tr-"+n+"__btn-activate",test_id:t.id+"__tr-"+n+"__btn-activate"},on:{click:function(e){return t.passActivateToParent(r)}}})],1)],1)])}),0)])]),t._v(" "),e("div",{staticClass:"w-100"},[e("div",{staticClass:"col-12 text-center text-lg-right"},[e("card-pagination-view",{attrs:{per_page:t.pagination.per_page,total_data:t.pagination.total_data,additional_class:"mt-3",current_page:t.pagination.current_page,id:"pagination_member",test_id:t.id+"__pagination"},on:{update:t.passUpdatePagination}})],1)])]),t._v(" "),t.corporate?e("modal-confirmation",{attrs:{is_loading:t.helper.is_loading,text:"Apakah anda yakin mengeluarkan "+t.selected.name+" ini dari daftar member perusahaan anda?",submit_button_text:"Submit"},on:{cancel:t.passCancelToParent,submit:t.processDeleteData},model:{value:t.modal.modal_delete,callback:function(e){t.$set(t.modal,"modal_delete",e)},expression:"modal.modal_delete"}}):t._e(),t._v(" "),t.corporate?e("modal-confirmation",{attrs:{is_loading:t.helper.is_loading,text:"Apakah anda yakin ingin "+(t.selected.status?"menonaktifkan":"mengaktifkan")+" "+t.selected.name+" dari daftar member perusahaan anda?",submit_button_text:"Submit"},on:{cancel:t.passCancelToParent,submit:t.processActivateData},model:{value:t.modal.modal_activate,callback:function(e){t.$set(t.modal,"modal_activate",e)},expression:"modal.modal_activate"}}):t._e()],1)},[],!1,null,null,null);e.default=component.exports}}]);