(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{814:function(e,t,n){"use strict";n.r(t),function(e){"undefined"!=typeof window?window:void 0!==e||"undefined"!=typeof self&&self;var n=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(e,t){e.exports=function e(data,t,n){var o,r,l=window,d="application/octet-stream",c=n||d,f=data,h=!t&&!n&&f,m=document.createElement("a"),y=function(a){return String(a)},x=l.Blob||l.MozBlob||l.WebKitBlob||y,w=t||"download";if(x=x.call?x.bind(l):Blob,"true"===String(this)&&(c=(f=[f,c])[0],f=f[1]),h&&h.length<2048&&(w=h.split("/").pop().split("?")[0],m.href=h,-1!==m.href.indexOf(h))){var v=new XMLHttpRequest;return v.open("GET",h,!0),v.responseType="blob",v.onload=function(t){e(t.target.response,w,d)},setTimeout(function(){v.send()},0),v}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(f)){if(!(f.length>2096103.424&&x!==y))return navigator.msSaveBlob?navigator.msSaveBlob(S(f),w):_(f);c=(f=S(f)).type||d}else if(/([\x80-\xff])/.test(f)){for(var i=0,k=new Uint8Array(f.length),C=k.length;i<C;++i)k[i]=f.charCodeAt(i);f=new x([k],{type:c})}function S(e){for(var t=e.split(/[:;,]/),n=t[1],o=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),r=o.length,i=0,l=new Uint8Array(r);i<r;++i)l[i]=o.charCodeAt(i);return new x([l],{type:n})}function _(e,t){if("download"in m)return m.href=e,m.setAttribute("download",w),m.className="download-js-link",m.innerHTML="downloading...",m.style.display="none",document.body.appendChild(m),setTimeout(function(){m.click(),document.body.removeChild(m),!0===t&&setTimeout(function(){l.URL.revokeObjectURL(m.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,d)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,d)),n.src=e,setTimeout(function(){document.body.removeChild(n)},333)}if(o=f instanceof x?f:new x([f],{type:c}),navigator.msSaveBlob)return navigator.msSaveBlob(o,w);if(l.URL)_(l.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===y)try{return _("data:"+c+";base64,"+l.btoa(o))}catch(e){return _("data:"+c+","+encodeURIComponent(o))}(r=new FileReader).onload=function(e){_(this.result)},r.readAsDataURL(o)}return!0}});var o=function(template,style,script,e,t,n,o,r,l,d){"boolean"!=typeof o&&(l=r,r=o,o=!1);var c,f="function"==typeof script?script.options:script;if(template&&template.render&&(f.render=template.render,f.staticRenderFns=template.staticRenderFns,f._compiled=!0,t&&(f.functional=!0)),e&&(f._scopeId=e),n?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),style&&style.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},f._ssrRegister=c):style&&(c=o?function(){style.call(this,d(this.$root.$options.shadowRoot))}:function(e){style.call(this,r(e))}),c)if(f.functional){var h=f.render;f.render=function(e,t){return c.call(t),h(e,t)}}else{var m=f.beforeCreate;f.beforeCreate=m?[].concat(m,c):[c]}return script};const r={props:{type:{type:String,default:"xls"},data:{type:Array,required:!1,default:null},fields:{type:Object,required:!1},exportFields:{type:Object,required:!1},defaultValue:{type:String,required:!1,default:""},title:{default:null},footer:{default:null},name:{type:String,default:"data.xls"},fetch:{type:Function},meta:{type:Array,default:()=>[]},worksheet:{type:String,default:"Sheet1"},beforeGenerate:{type:Function},beforeFinish:{type:Function}},computed:{idName:()=>"export_"+(new Date).getTime(),downloadFields(){return void 0!==this.fields?this.fields:void 0!==this.exportFields?this.exportFields:void 0}},methods:{async generate(){"function"==typeof this.beforeGenerate&&await this.beforeGenerate();let data=this.data;if("function"!=typeof this.fetch&&data||(data=await this.fetch()),!data||!data.length)return;let e=this.getProcessedJson(data,this.downloadFields);return"html"===this.type?this.export(this.jsonToXLS(e),this.name.replace(".xls",".html"),"text/html"):"csv"===this.type?this.export(this.jsonToCSV(e),this.name.replace(".xls",".csv"),"application/csv"):this.export(this.jsonToXLS(e),this.name,"application/vnd.ms-excel")},export:async function(data,e,t){let o=this.base64ToBlob(data,t);"function"==typeof this.beforeFinish&&await this.beforeFinish(),n(o,e,t)},jsonToXLS(data){let e="<thead>";const t=Object.keys(data[0]).length;let n=this;null!=this.title&&(e+=this.parseExtraData(this.title,'<tr><th colspan="'+t+'">${data}</th></tr>')),e+="<tr>";for(let t in data[0])e+="<th>"+t+"</th>";return e+="</tr>",e+="</thead>",e+="<tbody>",data.map(function(t,o){e+="<tr>";for(let o in t)e+="<td>"+n.valueReformattedForMultilines(t[o])+"</td>";e+="</tr>"}),e+="</tbody>",null!=this.footer&&(e+="<tfoot>",e+=this.parseExtraData(this.footer,'<tr><td colspan="'+t+'">${data}</td></tr>'),e+="</tfoot>"),'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>'.replace("${table}",e).replace("${worksheet}",this.worksheet)},jsonToCSV(data){var e=[];null!=this.title&&e.push(this.parseExtraData(this.title,"${data}\r\n"));for(let t in data[0])e.push(t),e.push(",");return e.pop(),e.push("\r\n"),data.map(function(t){for(let n in t){let o='="'+t[n]+'"';o.match(/[,"\n]/)&&(o='"'+o.replace(/\"/g,'""')+'"'),e.push(o),e.push(",")}e.pop(),e.push("\r\n")}),null!=this.footer&&e.push(this.parseExtraData(this.footer,"${data}\r\n")),e.join("")},getProcessedJson(data,header){let e=this.getKeys(data,header),t=[],n=this;return data.map(function(o,r){let l={};for(let label in e){let t=e[label];l[label]=n.getValue(t,o)}t.push(l)}),t},getKeys(data,header){if(header)return header;let e={};for(let t in data[0])e[t]=t;return e},parseExtraData(e,t){let n="";if(Array.isArray(e))for(var i=0;i<e.length;i++)n+=t.replace("${data}",e[i]);else n+=t.replace("${data}",e);return n},getValue(e,t){const n="object"!=typeof e?e:e.field;let o="string"!=typeof n?[]:n.split("."),r=this.defaultValue;return r=n?o.length>1?this.getValueFromNestedItem(t,o):this.parseValue(t[n]):t,e.hasOwnProperty("callback")&&(r=this.getValueFromCallback(r,e.callback)),r},valueReformattedForMultilines:e=>"string"==typeof e?e.replace(/\n/gi,"<br/>"):e,getValueFromNestedItem(e,t){let n=e;for(let e of t)n&&(n=n[e]);return this.parseValue(n)},getValueFromCallback(e,t){if("function"!=typeof t)return this.defaultValue;const n=t(e);return this.parseValue(n)},parseValue(e){return e||0===e||"boolean"==typeof e?e:this.defaultValue},base64ToBlob(data,e){let t=window.btoa(window.unescape(encodeURIComponent(data))),n=atob(t),o=n.length,r=new Uint8ClampedArray(o);for(;o--;)r[o]=n.charCodeAt(o);return new Blob([r],{type:e})}}};var l=function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{attrs:{id:e.idName},on:{click:e.generate}},[e._t("default",[e._v("\n\t\tDownload "+e._s(e.name)+"\n\t")])],2)};l._withStripped=!0;var d=o({render:l,staticRenderFns:[]},undefined,r,undefined,!1,undefined,void 0,void 0);t.default=d}.call(this,n(45))}}]);