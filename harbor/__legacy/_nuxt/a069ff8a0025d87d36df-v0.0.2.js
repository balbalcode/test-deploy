(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{885:function(t,e,n){"use strict";n.r(e);var r=n(1);n(10),n(463),n(69),n(90),n(9),n(41),n(25);var o={month:function(t){var e=[{value:"01",text:"Januari"},{value:"02",text:"Februari"},{value:"03",text:"Maret"},{value:"04",text:"April"},{value:"05",text:"Mei"},{value:"06",text:"Juni"},{value:"07",text:"Juli"},{value:"08",text:"Agustus"},{value:"09",text:"September"},{value:"10",text:"Oktober"},{value:"11",text:"November"},{value:"12",text:"Desember"}];return isFinite(t)?e[t]:e},vehicle:function(t){var e=[{value:"mt",text:"Motor"},{value:"mb",text:"Mobil"},{value:"kl",text:"Lainnya"}];return isFinite(t)?e[t]:e},global_timezone:function(t){var e=[{utc:"UTC+7 - Asia/Jakarta",gmt:"GMT+7 - Jakarta, Bangkok",local:"Waktu Indonesia Bagian Barat",short_local:"WIB",value:"Asia/Jakarta"},{utc:"UTC+8 - Asia/Ujung Pandang",gmt:"GMT+8 - Hongkong, Singapore",local:"Waktu Indonesia Bagian Tengah",short_local:"WITA",value:"Asia/Ujung_Pandang"},{utc:"UTC+9 - Asia/Jayapura",gmt:"GMT+9 - Tokyo, Osaka",local:"Waktu Indonesia Bagian Timur",short_local:"WIT",value:"Asia/Jayapura"}];return isFinite(t)?e[t]:e},TRANSACTION_PARTS:function(t){var e=[{value:"CONTAINER",text:"Spesifikasi dan Layanan Kontainer"},{value:"DRIVER",text:"Driver dan Truck"},{value:"PAYMENT",text:"Metode Pembayaran"}];return isFinite(t)?e[t]:e}},l=n(432),c={components:{ContentSpan:function(){return n.e(10).then(n.bind(null,891))},TabBar:function(){return n.e(22).then(n.bind(null,892))},PlainModal:function(){return Promise.all([n.e(1),n.e(2),n.e(4),n.e(7),n.e(5)]).then(n.bind(null,889))},ActiveButton:function(){return n.e(0).then(n.bind(null,888))},InputTextGroup:function(){return n.e(6).then(n.bind(null,887))},Layout:function(){return Promise.resolve().then(n.bind(null,156))},FormContainer:function(){return n.e(97).then(n.bind(null,926))},FormDriver:function(){return n.e(98).then(n.bind(null,927))},FormPaymentMethod:function(){return n.e(96).then(n.bind(null,928))}},data:function(){return{data:{container:[],driver:[],payment:{}},modal:{warning:!1},helper:{CORPORATE:"",tabs:o.TRANSACTION_PARTS(),state:"CONTAINER",isError:!1,isLoading:!1}}},watch:{},mounted:function(){this.helper.CORPORATE=JSON.parse(this.$utility.getCookie("corporate"))},methods:{createCorporateTransaction:l.transactionMethods.createCorporateTransaction,chargeCorporateTransaction:l.transactionMethods.chargeCorporateTransaction,processCheckData:function(t){var e=!0;"CONTAINER"===this.helper.state?this.$refs.form_container.processCheckContainer()&&(this.data.container=this.$refs.form_container.form.data,this.data.driver=this.$refs.form_container.form.data,this.helper.state=t.target_pane,e=!1):"DRIVER"===this.helper.state?this.$refs.form_driver.processCheckDriver()&&(this.data.container=this.$refs.form_driver.form.data,this.data.driver=this.$refs.form_driver.form.data,this.helper.state=t.target_pane,e=!1):"PAYMENT"===this.helper.state&&(this.data.payment=this.$refs.form_payment.form.payment,this.helper.state=t.target_pane,e=!1),this.modal.warning=e},processCheckDriver:function(){return this.data.driver.find(function(t){return!t.hasOwnProperty("id")}).number},togglePane:function(t){this.helper.state=t},processSetPayload:function(data,t){void 0===t&&(t=""),this.data.container=data,this.data.driver=data,""!==t&&(this.helper.state=t)},processMakePayloadCharge:function(t){return{item_details:[{id:t}],custom_expiry:{expiry_duration:"24",unit:"hours"},transaction_details:{order_id:t,transaction_type:"EXTERNAL_TRANSACTION_SERVICES"},user_id:this.helper.CORPORATE.id,payment_type:"bank_transfer",bank_transfer:{bank:"bca"}}},processMakePayloadTransaction:function(){var t=this,e={container_transactions:[],payment_method:this.data.payment.value,corporate_id:this.helper.CORPORATE.id,spot_id:this.helper.CORPORATE.spot_id};return this.data.driver.map(function(n){e.container_transactions.push({container_id:"",ventilator_count:n.ventilatorCount.value,vehicle_size:n.vehicleSize.value,vehicle_type:n.vehicleType.value,container_fill:n.isFilled.value,container_code:n.number,product_list:n.selectedPackage.map(function(t){return t.id}),time_out_estimation:t.$utility.formatDateMoment(n.exitEstimation,"YYYY-MM-DD"),driver_id:n.driver.id})}),e},processSubmitPayload:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark(function e(){var n,r,o,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.helper.isLoading=!0,n=t.processMakePayloadTransaction(),e.next=1,t.createCorporateTransaction(n);case 1:return r=e.sent,o=r.values,l=t.processMakePayloadCharge(o.id),e.next=2,t.chargeCorporateTransaction(l);case 2:console.log(o),t.helper.isLoading=!1,t.$router.push("/transaction/detail?id="+o.id),e.next=4;break;case 3:e.prev=3,c=e.catch(0),t.helper.isError=!0,t.$utility.setErrorContextSentry(c),t.$sentry.captureMessage(c.message+" at processGetPackage in FormOptionsPackage"),t.helper.isLoading=!1;case 4:case"end":return e.stop()}},e,null,[[0,3]])}))()}}},d=n(38),component=Object(d.a)(c,function(){var t=this,e=t._self._c;return e("div",{staticClass:"font-size-13"},[e("h5",{staticClass:"float-left font-weight-bold align-self-center font-size-20 mb-3"},[t._v("\n    Buat Transaksi\n  ")]),t._v(" "),t.helper.isLoading?e("div",{staticClass:"text-center mx-auto my-5 py-5"},[e("content-span",{attrs:{size:"lg",caption:""}}),t._v(" "),t._m(0)],1):t.helper.isError?e("div",{staticClass:"text-center mx-auto my-5 py-5"},[e("content-span",{attrs:{size:"lg",caption:"",image:"error.png",has_animation:!1}}),t._v(" "),t._m(1),t._v(" "),e("active-button",{attrs:{text:"Buat Kembali",size:"sm",additional_class:"mt-3 px-5"},on:{click:function(e){t.helper.isError=!1}}})],1):e("div",[e("tab-bar",{attrs:{tabs:t.helper.tabs,has_number:"",default_action:!1},on:{change:t.processCheckData},model:{value:t.helper.state,callback:function(e){t.$set(t.helper,"state",e)},expression:"helper.state"}}),t._v(" "),"PAYMENT"!==t.helper.state?e("div",{staticClass:"rounded-lg bg-white shadow p-3 my-3"},["CONTAINER"===t.helper.state?e("form-container",{ref:"form_container",attrs:{data:t.data.container,corporate:t.helper.CORPORATE},on:{saved:function(data){t.processSetPayload(data,"DRIVER")}}}):t._e(),t._v(" "),"DRIVER"===t.helper.state?e("form-driver",{ref:"form_driver",attrs:{data:t.data.driver,corporate:t.helper.CORPORATE},on:{back:function(e){t.helper.state="CONTAINER"},saved:function(data){t.processSetPayload(data,"PAYMENT")}}}):t._e()],1):t._e(),t._v(" "),"PAYMENT"===t.helper.state?e("form-payment-method",{ref:"form_payment",attrs:{data:t.data.driver,corporate:t.helper.CORPORATE,"payment-selected":t.data.payment},on:{back:function(e){t.helper.state="DRIVER"},saved:function(e){t.data.payment=e,t.processSubmitPayload()}}}):t._e()],1),t._v(" "),e("plain-modal",{attrs:{size:"sm"},model:{value:t.modal.warning,callback:function(e){t.$set(t.modal,"warning",e)},expression:"modal.warning"}},[e("div",{staticClass:"mt-0 mb-2"},[e("i",{staticClass:"bx bx-error-circle",staticStyle:{"font-size":"64px"}}),t._v(" "),e("p",{staticClass:"font-size-12 mt-3"},[e("span",{staticClass:"font-weight-bold font-size-14"},[t._v("\n          Data tidak lengkap!\n        ")]),t._v(" "),e("br"),t._v(" "),e("span",[t._v("\n          Anda harus melengkapi data terlebih dahulu untuk pindah halaman\n        ")])]),t._v(" "),e("active-button",{attrs:{size:"sm",text:"Tutup dan Mengerti",additional_class:"w-100"},on:{click:function(e){t.modal.warning=!1}}})],1)])],1)},[function(){var t=this._self._c;return t("h5",{staticClass:"font-weight-bold mt-n4"},[this._v("\n      Menyimpan data "),t("i",{staticClass:"bx bx-spin bx-loader-alt"})])},function(){var t=this._self._c;return t("h5",{staticClass:"font-weight-bold mt-n4 text-danger"},[this._v("\n      Gagal Menyimpan data "),t("i",{staticClass:"bx bx-error-circle"})])}],!1,null,null,null);e.default=component.exports}}]);